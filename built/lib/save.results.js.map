{"version":3,"sources":["../../src/lib/save.results.js"],"names":["SaveResults","client","config","fields","id","results","type","docs","each","result","push","index","_index","rule","key","_type","_id","doc","length","save"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AACA;;;;IAEaA,W,WAAAA,W;;;AACT,yBAAYC,MAAZ,EAAoBC,MAApB,EAA4BC,MAA5B,EAAoC;AAAA;AAAA,+IAC1BF,MAD0B,EAClBC,MADkB,EACVC,MADU;AAEnC;;;;;mGAEUC,E,EAAIC,O,EAASC,I;;;;;;AAChBC,oC,GAAO,E;;AAEX;;AACA,iDAAEC,IAAF,CAAOH,OAAP,EAAgB,UAACI,MAAD,EAAY;AACxBF,yCAAKG,IAAL,CAAU;AACNC,+CAAO;AACHC,oDAAQH,OAAOI,IAAP,CAAYC,GADjB;AAEHC,mDAAOT,IAFJ;AAGHU,iDAAKZ;AAHF;AADD,qCAAV;AAOAG,yCAAKG,IAAL,CAAU,EAAEO,KAAKR,OAAOA,MAAd,EAAV;AACH,iCATD;;qCAWIF,KAAKW,M;;;;;;uCACQ,KAAKC,IAAL,CAAUZ,IAAV,C;;;;;;iEAGV,E","file":"save.results.js","sourcesContent":["import _ from \"lodash\";\nimport { SaveBase } from \"./save.base\";\n\nexport class SaveResults extends SaveBase {\n    constructor(client, config, fields) {\n        super(client, config, fields);\n    }\n\n    async deal(id, results, type) {\n        let docs = [];\n\n        // 保存分析出来的数据\n        _.each(results, (result) => {\n            docs.push({\n                index: {\n                    _index: result.rule.key,\n                    _type: type,\n                    _id: id\n                }\n            });\n            docs.push({ doc: result.result });\n        });\n\n        if (docs.length) {\n            return await this.save(docs);\n        }\n\n        return {};\n    }\n}"]}